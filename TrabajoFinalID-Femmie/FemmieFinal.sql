DROP TABLE TELEFONO;
DROP TABLE REALIZAR_PEDIDO;
DROP TABLE CLIENTE;
DROP TABLE DELIVERY;
DROP TABLE CONT_PROD;    
DROP TABLE PRODUCTO;
DROP TABLE PEDIDO;
DROP TABLE PROMOCION;
DROP TABLE EMPAQUE;
DROP TABLE REGISTRAR_EMP;
DROP TABLE REGISTRAR_PROD;
DROP TABLE ALMACEN;
DROP TABLE REGISTRAR_TELA;  
DROP TABLE TELA;   
DROP TABLE COMPRA_TELA;       
DROP TABLE PROVEEDORES;
DROP TABLE EMPLEADO;
DROP TABLE ADMINISTRADOR;
DROP TABLE ATENCION_AL_CLIENTE;
DROP TABLE COMPRAR_EMPAQUE;
DROP TABLE TEL_PROVEEDOR;
 

CREATE TABLE CLIENTE(
    DNI VARCHAR2(30) PRIMARY KEY,
    NOMBRE VARCHAR2(100) NOT NULL,
    CORREO VARCHAR2 (100) NOT NULL,
    DIRECCION VARCHAR2 (100) NOT NULL    
);



---------------------------------------------------------------------------------------------------------

CREATE TABLE TELEFONO(
    DNI VARCHAR2(30) REFERENCES CLIENTE NOT NULL,
    TELEFONO_CLIENTE VARCHAR2(30) NOT NULL    
);



---------------------------------------------------------------------------------------------------------

CREATE TABLE DELIVERY(
    COD_DELIVERY VARCHAR2(30) PRIMARY KEY NOT NULL,
    NOMBRE_DELIVERY VARCHAR2(100) NOT NULL,
    COSTO NUMBER(10) NOT NULL,
    TIPO VARCHAR2(100) NOT NULL
);


---------------------------------------------------------------------------------------------------------
CREATE TABLE PROMOCION
(
    COD_PROMOCION VARCHAR2(30) PRIMARY KEY,
    NOMBRE_PROM VARCHAR2(30) NOT NULL,
    DESCUENTO NUMBER(10) NOT NULL
);


------------------------------------------------------------------------------------------------
CREATE TABLE PEDIDO(
    NUM_PEDIDO VARCHAR2(30) PRIMARY KEY NOT NULL,
    COD_PROMOCION VARCHAR2(30) REFERENCES PROMOCION,
    COD_DELIVERY VARCHAR2(30),
    FECHA_REGISTRO DATE ,
    FECHA_ENTREGA DATE
);
------------------------------------------------------------------------------------------------------
CREATE TABLE REALIZAR_PEDIDO(
    NUM_PEDIDO VARCHAR2(30) REFERENCES PEDIDO ,
    DNI VARCHAR2(30) REFERENCES CLIENTE ,
    ESTADO_PEDIDO VARCHAR2(100),
    TARJETA VARCHAR2(30),
    N_CUENTA VARCHAR2(40)
);


---------------------------------------------------------------------------------------------------------


CREATE TABLE PRODUCTO
( 
   SKU VARCHAR2(30) PRIMARY KEY NOT NULL,
   SECCION VARCHAR2(30) NOT NULL,
   CATEGORIA VARCHAR2(30) NOT NULL,
   LINEA VARCHAR2(30) NOT NULL,
   MODELO VARCHAR2(30) NOT NULL,
   COLOR VARCHAR2(30) NOT NULL,
   MEDIDA VARCHAR2(30) NOT NULL,
   PRECIO_UNITARIO FLOAT(30)
) ; 



---------------------------------------------------------------------------------------------------------

CREATE TABLE EMPAQUE
( 
   COD_EMP VARCHAR2(30) PRIMARY KEY  ,
   TIPO VARCHAR2(30) ,
   COSTO NUMBER(20) 
) ;

INSERT INTO EMPAQUE VALUES ('22254','CAJA', 15 );
INSERT INTO EMPAQUE VALUES ('34576','BOLSA', 10);

-----------------------------------------------------------------------------------------------

CREATE TABLE ALMACEN
(
    COD_ALM VARCHAR2(30) PRIMARY KEY,
    COD_USUARIO  VARCHAR2(30)
);
INSERT INTO ALMACEN VALUES ('A', '75358792' );
INSERT INTO ALMACEN VALUES ('B', '86248657');
INSERT INTO ALMACEN VALUES ('M', '96541285' );

------------------------------------------------------------------------------------------------------------

CREATE TABLE REGISTRAR_EMP
( 
   COD_EMP VARCHAR2(30)  ,
   COD_ALM VARCHAR2(30) REFERENCES ALMACEN  ,
   CANTIDAD NUMBER(20)  ,
   TRANSFERIDO NUMBER(20)  ,
   DEFECTUOSO NUMBER(20)  ,
   FECHA DATE
) ;

INSERT INTO REGISTRAR_EMP VALUES (22254,'A', 10, 2, 3, TO_DATE('10-DIC-2020', 'dd-MON-yyyy') );
INSERT INTO REGISTRAR_EMP VALUES (34576,'A', 14, 1, 2, TO_DATE('01-JUN-2021', 'dd-MON-yyyy'));
INSERT INTO REGISTRAR_EMP VALUES (34576,'B', 5 , 0, 1, TO_DATE('22-OCT-2021', 'dd-MON-yyyy'));
INSERT INTO REGISTRAR_EMP VALUES (34576,'M', 10, 3, 1, TO_DATE('07-SEP-2020', 'dd-MON-yyyy') );

-------------------------------------------------------------------------------------------------
CREATE TABLE REGISTRAR_PROD
( 
   SKU VARCHAR2(30),
   COD_ALM VARCHAR2(30) REFERENCES ALMACEN ,
   CANTIDAD NUMBER(20) ,
   TRANSFERIDO NUMBER(20) ,
   FECHA DATE
) ;

INSERT INTO REGISTRAR_PROD VALUES ('111111','A', 9,  2, TO_DATE('30-JUL-2020', 'dd-MON-yyyy') );
INSERT INTO REGISTRAR_PROD VALUES ('111231','A', 6,  4, TO_DATE('15-FEB-2021', 'dd-MON-yyyy'));
INSERT INTO REGISTRAR_PROD VALUES ('111231','B', 3 , 2, TO_DATE('20-JUN-2020', 'dd-MON-yyyy'));
INSERT INTO REGISTRAR_PROD VALUES ('111162','M', 10, 0, TO_DATE('15-OCT-2020', 'dd-MON-yyyy') );


---------------------------------------------------------------------------------------------------

CREATE TABLE CONT_PROD
(
    NUM_PEDIDO VARCHAR2(30) REFERENCES PEDIDO,
    SKU  VARCHAR2(30) REFERENCES PRODUCTO,
    CANTIDAD NUMBER(20) 
);


------------------------------------------------------------
CREATE TABLE TELA
(
    COD_TELA VARCHAR2(30) PRIMARY KEY NOT NULL,
    TIPO  VARCHAR2(30) NOT NULL,
    COSTO NUMBER(20) NOT NULL,
    COLOR VARCHAR2(30) NOT NULL
);
INSERT INTO TELA VALUES ('001', 'SATIN',30,'GRIS LAVANDA' );
INSERT INTO TELA VALUES ('002', 'SATIN',30,'ROSE GOLD');
INSERT INTO TELA VALUES ('003', 'SATIN',30,'GOLDEN');
---------------------------------------------------------------
CREATE TABLE REGISTRAR_TELA
( 
   COD_ALM VARCHAR2(30) ,
   COD_TELA VARCHAR2(30) REFERENCES TELA ,
   CANTIDAD NUMBER(20) ,--EN METROS
   FECHA DATE
) ;

INSERT INTO REGISTRAR_TELA VALUES ('A','001', 6,   TO_DATE('10-NOV-2021', 'dd-MON-yyyy') );
INSERT INTO REGISTRAR_TELA VALUES ('B','002', 17,  TO_DATE('10-NOV-2021', 'dd-MON-yyyy'));
INSERT INTO REGISTRAR_TELA VALUES ('M','003', 20 , TO_DATE('23-OCT-2020', 'dd-MON-yyyy'));
INSERT INTO REGISTRAR_TELA VALUES ('B','003', 12,  TO_DATE('05-SEP-2020', 'dd-MON-yyyy'));
--------------------------------------------------------------------------
CREATE TABLE PROVEEDORES(
    RUC_PROVEEDOR VARCHAR2(30) PRIMARY KEY NOT NULL,
    RAZON_SOCIAL VARCHAR2(50)     
);

INSERT INTO PROVEEDORES VALUES('20304984314', 'SATINSAC');
INSERT INTO PROVEEDORES VALUES('20409244432', 'EMPAQUESAC');
INSERT INTO PROVEEDORES VALUES('20561043213', 'TELAFAST');
--------
CREATE TABLE COMPRA_TELA
( 
   COD_TELA VARCHAR2(30) ,
   RUC_PROVEEDOR VARCHAR2(30) REFERENCES PROVEEDORES,
   FECHA_VENTA DATE
) ;
INSERT INTO COMPRA_TELA VALUES ('001', '20304984314', TO_DATE('09-NOV-2021', 'dd-MON-yyyy') );
INSERT INTO COMPRA_TELA VALUES ('002', '20561043213',  TO_DATE('09-NOV-2021', 'dd-MON-yyyy'));
INSERT INTO COMPRA_TELA VALUES ('003', '20409244432',  TO_DATE('22-OCT-2020', 'dd-MON-yyyy'));
 
-----------------------------------------------------------------------------------------
CREATE TABLE EMPLEADO
(
    COD_USUARIO VARCHAR2(30) PRIMARY KEY,
    NOMBRE VARCHAR2(40) NOT NULL
);

INSERT INTO EMPLEADO VALUES ('75358792', 'ANABEL');
INSERT INTO EMPLEADO VALUES ('86248657', 'BERTILA');
INSERT INTO EMPLEADO VALUES ('96541285', 'MELANI' );
INSERT INTO EMPLEADO VALUES ('47852149', 'ELIZABETH' );

-----------------------------------------------------------------------------------
CREATE TABLE ADMINISTRADOR
(
    COD_USUARIO VARCHAR2(30)REFERENCES EMPLEADO,
    CLAVE VARCHAR2(30) NOT NULL,
    NOM_USUARIO VARCHAR(30)
);

INSERT INTO ADMINISTRADOR VALUES ('75358792', 'anabel23456'  ,'2345Anabel2345');
INSERT INTO ADMINISTRADOR VALUES ('86248657', 'bertila12345' ,'1234Bertila1234');
INSERT INTO ADMINISTRADOR VALUES ('96541285', 'melanie34567' ,'3456Melanie3456');
-------------------------------------------------------------
CREATE TABLE ATENCION_AL_CLIENTE
(
    COD_USUARIO VARCHAR2(30) REFERENCES EMPLEADO,    
    MEDIO_CONTACTO VARCHAR2(20) NOT NULL
);
INSERT INTO ATENCION_AL_CLIENTE VALUES ('47852149','INSTAGRAM');


-------------------------------
CREATE TABLE COMPRAR_EMPAQUE
(
    COD_EMP VARCHAR2(30) REFERENCES EMPAQUE,
    FECHA_VENTA DATE ,
    RUC_PROVEEDOR VARCHAR2(30) REFERENCES PROVEEDORES
);

INSERT INTO COMPRAR_EMPAQUE VALUES ('22254', TO_DATE('09-NOV-2021', 'dd-MON-yyyy'), '20304984314');
INSERT INTO COMPRAR_EMPAQUE VALUES ('34576', TO_DATE('11-NOV-2021', 'dd-MON-yyyy'), '20409244432');
INSERT INTO COMPRAR_EMPAQUE VALUES ('22254', TO_DATE('23-NOV-2021', 'dd-MON-yyyy'), '20561043213');



---------------------------------------------------------------
CREATE TABLE TEL_PROVEEDOR
(
  RUC_PROVEEDOR VARCHAR2(30) REFERENCES PROVEEDORES  ,
  TELEFONO_PRIV VARCHAR2(30)   
);

INSERT INTO TEL_PROVEEDOR VALUES('20304984314', '927526314');
INSERT INTO TEL_PROVEEDOR VALUES('20304984314', '999147963');
INSERT INTO TEL_PROVEEDOR VALUES('20409244432', '914645284');
INSERT INTO TEL_PROVEEDOR VALUES('20561043213', '945963214');



DROP TABLE PEDIDOaux;

CREATE TABLE PEDIDOaux(
    NUM_PEDIDO2 VARCHAR2(30) PRIMARY KEY ,
    COD_PROMOCION2 VARCHAR2(30) ,
    COD_DELIVERY2 VARCHAR2(30),
    FECHA_REGISTRO2 DATE ,
    FECHA_ENTREGA2 DATE
);

--Actualizar datos para cod_promocion
UPDATE PEDIDOaux SET COD_PROMOCION2 = NULL
WHERE COD_PROMOCION2 = 'null';

--Actualizar datos para cod_delivery
UPDATE PEDIDOaux SET COD_DELIVERY2 = NULL
WHERE COD_DELIVERY2 = 'null';

INSERT INTO PEDIDO(
    SELECT NUM_PEDIDO2, COD_PROMOCION2 ,COD_DELIVERY2,FECHA_REGISTRO2 ,FECHA_ENTREGA2
    FROM PEDIDOaux 
);


